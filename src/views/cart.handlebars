<div class="container">
  <h1>Carrito</h1>
  <table class="table table-responsive">
    <thead>
      <tr>
        <th scope="col"></th>
        <th scope="col">Producto</th>
        <th scope="col">Precio unitario</th>
        <th scope="col">Cantidad</th>
        <th scope="col">Subtotal</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
      <% for (let item of cart.products) { %>
      <tr>
        <td><img src="<%= item.productId.thumbnail %>" alt="<%= item.productId.title %>" class="img-thumbnail"></td>
        <td><%= item.productId.title %></td>
        <td>$<%= item.price %></td>
        <td>
          <form action="/api/v1/carts/<%= cart._id %>/products/<%= item.productId._id %>" method="POST">
            <input type="number" name="quantity" value="<%= item.quantity %>" class="form-control form-control-sm">
            <button type="submit" class="btn btn-sm btn-primary mt-2">Actualizar</button>
          </form>
        </td>
        <td>$<%= Math.round(item.price * item.quantity * 100) / 100 %></td>
        <td>
          <form action="/api/v1/carts/<%= cart._id %>/products/<%= item.productId._id %>" method="POST">
            <input type="hidden" name="_method" value="DELETE">
            <button type="submit" class="btn btn-sm btn-danger">Eliminar</button>
          </form>
        </td>
      </tr>
      <% } %>
    </tbody>
    <tfoot>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <th scope="row">Total:</th>
        <td><strong>$ <%= Math.round(cart.totalPrice * 100) / 100 %></strong></td>
        <td>
          <form action="/api/v1/carts/<%= cart._id %>" method="POST">
            <input type="hidden" name="_method" value="PUT">
            <button type="submit" class="btn btn-sm btn-success">Pagar</button>
          </form>
        </td>
      </tr>
    </tfoot>
  </table>
  <div class="mt-3">
    <a href="/" class="btn btn-primary">Volver al listado de productos</a>
  </div>
</div>
